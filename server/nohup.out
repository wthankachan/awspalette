 * Serving Flask app 'app'
 * Debug mode: on
[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:8081
 * Running on http://172.31.37.196:8081
[33mPress CTRL+C to quit[0m
 * Restarting with watchdog (inotify)
 * Debugger is active!
 * Debugger PIN: 167-142-982
172.31.37.196 - - [01/Oct/2025 00:14:54] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 27, in getcustomers
    if self.conn is None or self.conn.closed:
                            ^^^^^^^^^^^^^^^^
AttributeError: 'Connection' object has no attribute 'closed'. Did you mean: 'close'?
172.31.37.196 - - [01/Oct/2025 00:15:04] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 27, in getcustomers
    if self.conn is None or self.conn.closed:
                            ^^^^^^^^^^^^^^^^
AttributeError: 'Connection' object has no attribute 'closed'. Did you mean: 'close'?
172.31.37.196 - - [01/Oct/2025 00:15:20] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 27, in getcustomers
    if self.conn is None or self.conn.closed:
                            ^^^^^^^^^^^^^^^^
AttributeError: 'Connection' object has no attribute 'closed'. Did you mean: 'close'?
76.193.45.35 - - [01/Oct/2025 00:15:37] "[33mGET /customer HTTP/1.1[0m" 404 -
76.193.45.35 - - [01/Oct/2025 00:15:37] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
76.193.45.35 - - [01/Oct/2025 00:15:46] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 27, in getcustomers
    if self.conn is None or self.conn.closed:
                            ^^^^^^^^^^^^^^^^
AttributeError: 'Connection' object has no attribute 'closed'. Did you mean: 'close'?
76.193.45.35 - - [01/Oct/2025 00:15:46] "GET /customers?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1" 200 -
76.193.45.35 - - [01/Oct/2025 00:15:46] "GET /customers?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1" 200 -
76.193.45.35 - - [01/Oct/2025 00:15:46] "GET /customers?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1" 200 -
172.31.37.196 - - [01/Oct/2025 00:21:23] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 27, in getcustomers
    if self.conn is None or self.conn.closed:
                            ^^^^^^^^^^^^^^^^
AttributeError: 'Connection' object has no attribute 'closed'. Did you mean: 'close'?
 * Detected change in '/home/ec2-user/awspalette/server/utils/database/cdp.py', reloading
 * Detected change in '/home/ec2-user/awspalette/server/utils/database/cdp.py', reloading
 * Detected change in '/home/ec2-user/awspalette/server/utils/database/cdp.py', reloading
 * Restarting with watchdog (inotify)
 * Debugger is active!
 * Debugger PIN: 167-142-982
 * Detected change in '/home/ec2-user/awspalette/server/utils/database/cdp.py', reloading
 * Detected change in '/home/ec2-user/awspalette/server/utils/database/cdp.py', reloading
 * Restarting with watchdog (inotify)
 * Debugger is active!
 * Debugger PIN: 167-142-982
 * Detected change in '/home/ec2-user/awspalette/server/utils/database/cdp.py', reloading
 * Detected change in '/home/ec2-user/awspalette/server/utils/database/cdp.py', reloading
 * Detected change in '/home/ec2-user/awspalette/server/utils/database/cdp.py', reloading
 * Restarting with watchdog (inotify)
 * Debugger is active!
 * Debugger PIN: 167-142-982
172.31.37.196 - - [01/Oct/2025 00:23:59] "GET /customers HTTP/1.1" 200 -
172.31.37.196 - - [01/Oct/2025 00:24:39] "GET /customerprofile/2620 HTTP/1.1" 200 -
172.31.37.196 - - [01/Oct/2025 00:25:02] "GET /customerprofile/2973 HTTP/1.1" 200 -
172.31.37.196 - - [01/Oct/2025 00:25:18] "GET /customerprofile/2620 HTTP/1.1" 200 -
90.151.171.106 - - [01/Oct/2025 00:31:27] "[33mCONNECT eth0.me:443 HTTP/1.1[0m" 404 -
90.151.171.106 - - [01/Oct/2025 00:31:37] code 400, message Bad request syntax ('\x04\x01\x00P¼ra\x010\x00')
90.151.171.106 - - [01/Oct/2025 00:31:37] "[31m[1m\x04\x01\x00P¼ra\x010\x00[0m" 400 -
90.151.171.106 - - [01/Oct/2025 00:31:37] "[32mGET http://eth0.me?Z77835226130Q1 HTTP/1.1[0m" 308 -
90.151.171.106 - - [01/Oct/2025 00:31:47] code 400, message Bad request syntax ('\x05\x01\x00')
90.151.171.106 - - [01/Oct/2025 00:31:47] "[31m[1m\x05\x01\x00[0m" 400 -
172.31.37.196 - - [01/Oct/2025 00:31:52] "GET /customers HTTP/1.1" 200 -
172.31.37.196 - - [01/Oct/2025 00:35:39] "GET /customers HTTP/1.1" 200 -
172.31.37.196 - - [01/Oct/2025 00:35:43] "GET /customers HTTP/1.1" 200 -
172.31.37.196 - - [01/Oct/2025 00:35:53] "GET /customerprofile/2340 HTTP/1.1" 200 -
172.31.37.196 - - [01/Oct/2025 00:36:03] "GET /customerprofile/2716 HTTP/1.1" 200 -
172.31.37.196 - - [01/Oct/2025 00:37:15] "GET /customerprofile/2716 HTTP/1.1" 200 -
172.31.37.196 - - [01/Oct/2025 00:37:38] "GET /customerprofile/2340 HTTP/1.1" 200 -
<h1>Customer Profile for 2620</h1>

<h2>Demographic Information</h2>
<p>
- Gender: Female
- Age Range: 35-45 years old
- Location: Los Angeles, CA
</p>

<h2>Purchase History</h2>
<p>
- Frequently purchases high-end beauty and skincare products
- Recently purchased a luxury handbag and matching accessories
- Shows interest in designer fashion and lifestyle products
</p>

<h2>Interests and Preferences</h2>
<p>
- Passionate about fashion, beauty, and home decor
- Enjoys attending local art exhibits and cultural events
- Prefers shopping at upscale boutiques and department stores
- Frequently researches new trends and products online
</p>

<h2>Recommendations</h2>
<p>
Based on the customer's demographic information and purchase history, recommended products may include:
- Luxury skincare sets and limited edition makeup products
- High-end handbags, wallets, and other fashion accessories
- Tickets to upcoming art gallery openings or luxury lifestyle events
- Home decor items and furnishings from premium brands
</p><h1>Customer Profile for 2973</h1>

<h2>Demographic Information</h2>
<p>
- Gender: Male
- Age Range: 25-35 years old
- Location: New York, NY
</p>

<h2>Purchase History</h2>
<p>
- Frequently purchases tech gadgets and electronics
- Recently purchased a new smartphone, laptop, and gaming console
- Shows interest in smart home devices and virtual reality products
</p>

<h2>Interests and Preferences</h2>
<p>
- Passionate about the latest technology and innovations
- Enjoys gaming, streaming content, and exploring new digital experiences
- Prefers shopping online for the best deals and user reviews
- Frequently researches new product releases and trends in the tech industry
</p>

<h2>Recommendations</h2>
<p>
Based on the customer's demographic information and purchase history, recommended products may include:
- Latest flagship smartphones, tablets, and other mobile devices
- High-performance laptops, desktops, and gaming PCs
- Cutting-edge virtual reality headsets and accessories
- Smart home automation products and voice-controlled devices
- Subscriptions to popular streaming services and gaming platforms
</p><h1>Customer Profile for 2620</h1>

<h2>Demographic Information</h2>
<p>
- Gender: Female
- Age Range: 35-45 years old
- Location: Los Angeles, CA
</p>

<h2>Purchase History</h2>
<p>
- Frequently purchases high-end beauty and skincare products
- Recently purchased a luxury handbag and matching accessories
- Shows interest in designer fashion and lifestyle products
</p>

<h2>Interests and Preferences</h2>
<p>
- Passionate about fashion, beauty, and home decor
- Enjoys attending local art exhibits and cultural events
- Prefers shopping at upscale boutiques and department stores
- Frequently researches new trends and products online
</p>

<h2>Recommendations</h2>
<p>
Based on the customer's demographic information and purchase history, recommended products may include:
- Luxury skincare sets and limited edition makeup products
- High-end handbags, wallets, and other fashion accessories
- Tickets to upcoming art gallery openings or luxury lifestyle events
- Home decor items and furnishings from premium brands
</p><h1>Customer Profile for 2340</h1>

<h2>Demographic Information</h2>
<p>
- Gender: Male
- Age Range: 45-55 years old
- Location: Chicago, IL
</p>

<h2>Purchase History</h2>
<p>
- Frequently purchases high-quality outdoor gear and sporting equipment
- Recently purchased a new fishing rod, camping gear, and hiking boots
- Shows interest in adventure travel and nature-based experiences
</p>

<h2>Interests and Preferences</h2>
<p>
- Passionate about outdoor recreation and exploration
- Enjoys hiking, fishing, camping, and other outdoor activities
- Prefers shopping at specialty outdoor retailers and outdoor outfitters
- Frequently researches new gear and equipment for his hobbies
</p>

<h2>Recommendations</h2>
<p>
Based on the customer's demographic information and purchase history, recommended products may include:
- Premium outdoor apparel and technical fabrics
- Advanced fishing rods, reels, and other fishing accessories
- High-quality camping equipment and survival gear
- Adventure travel packages and guided outdoor experiences
</p><h1>Customer Profile for 2716</h1>

<h2>Demographic Information</h2>
<p>
- Gender: Female
- Age Range: 25-35 years old
- Location: Seattle, WA
</p>

<h2>Purchase History</h2>
<p>
- Frequently purchases organic and sustainable clothing and home goods
- Recently purchased eco-friendly cleaning products and reusable items
- Shows interest in holistic wellness and natural lifestyle products
</p>

<h2>Interests and Preferences</h2>
<p>
- Passionate about environmental sustainability and ethical consumption
- Enjoys exploring farmers markets, local boutiques, and co-ops
- Prefers shopping for products that align with her values and beliefs
- Frequently researches new green brands and sustainable alternatives
</p>

<h2>Recommendations</h2>
<p>
Based on the customer's demographic information and purchase history, recommended products may include:
- Organic cotton clothing and bamboo-based home textiles
- All-natural personal care items and essential oil-based products
- Locally-sourced and artisanal food and beverage items
- Zero-waste kitchen and home organization solutions
- Experiences like eco-tours, wellness retreats, and sustainable workshops
</p><h1>Customer Profile for 2716</h1>

<h2>Demographic Information</h2>
<p>
- Gender: Female
- Age Range: 25-35 years old
- Location: Seattle, WA
</p>

<h2>Purchase History</h2>
<p>
- Frequently purchases organic and sustainable clothing and home goods
- Recently purchased eco-friendly cleaning products and reusable items
- Shows interest in holistic wellness and natural lifestyle products
</p>

<h2>Interests and Preferences</h2>
<p>
- Passionate about environmental sustainability and ethical consumption
- Enjoys exploring farmers markets, local boutiques, and co-ops
- Prefers shopping for products that align with her values and beliefs
- Frequently researches new green brands and sustainable alternatives
</p>

<h2>Recommendations</h2>
<p>
Based on the customer's demographic information and purchase history, recommended products may include:
- Organic cotton clothing and bamboo-based home textiles
- All-natural personal care items and essential oil-based products
- Locally-sourced and artisanal food and beverage items
- Zero-waste kitchen and home organization solutions
- Experiences like eco-tours, wellness retreats, and sustainable workshops
</p><h1>Customer Profile for 2340</h1>

<h2>Demographic Information</h2>
<p>
- Gender: Male
- Age Range: 45-55 years old
- Location: Chicago, IL
</p>

<h2>Purchase History</h2>
<p>
- Frequently purchases high-quality outdoor gear and sporting equipment
- Recently purchased a new fishing rod, camping gear, and hiking boots
- Shows interest in adventure travel and nature-based experiences
</p>

<h2>Interests and Preferences</h2>
<p>
- Passionate about outdoor recreation and exploration
- Enjoys hiking, fishing, camping, and other outdoor activities
- Prefers shopping at specialty outdoor retailers and outdoor outfitters
- Frequently researches new gear and equipment for his hobbies
</p>

<h2>Recommendations</h2>
<p>
Based on the customer's demographic information and purchase history, recommended products may include:
- Premium outdoor apparel and technical fabrics
- Advanced fishing rods, reels, and other fishing accessories
- High-quality camping equipment and survival gear
- Adventure travel packages and guided outdoor experiences
</p><h1>Customer Profile for 2269</h1>

<h2>Demographic Information</h2>
<p>
- Gender: Female
- Age Range: 18-25 years old
- Location: Atlanta, GA
</p>

<h2>Purchase History</h2>
<p>
- Frequently purchases trendy, affordable fashion and accessories
- Recently purchased several pieces of budget-friendly clothing and shoes
- Shows interest in social media-driven fashion and beauty trends
</p>

<h2>Interests and Preferences</h2>
<p>
- Passionate about keeping up with the latest fashion and beauty crazes
- Enjoys shopping at fast-fashion retailers and online marketplaces
- Prefers buying inexpensive, versat172.31.37.196 - - [01/Oct/2025 00:37:54] "GET /customerprofile/2269 HTTP/1.1" 200 -
172.31.37.196 - - [01/Oct/2025 00:39:44] "GET /customerprofile/2870 HTTP/1.1" 200 -
172.31.37.196 - - [01/Oct/2025 00:41:04] "GET /customerprofile/2457 HTTP/1.1" 200 -
65.49.1.80 - - [01/Oct/2025 00:56:28] code 400, message Bad HTTP/0.9 request type ('\x16\x03\x01\x00{\x01\x00\x00w\x03\x03í\x9b\x93L9QÓÆ\x00[\x9a\x9a²\x0e\x88^\x89\x9d6\x80`4\xad×\x135Y\x05Þ{þJ\x00\x00\x1aÀ/À+À\x11À\x07À\x13À')
65.49.1.80 - - [01/Oct/2025 00:56:28] "[31m[1m\x16\x03\x01\x00{\x01\x00\x00w\x03\x03í\x9b\x93L9QÓÆ\x00[\x9a\x9a²\x0e\x88^\x89\x9d6\x80`4­×\x135Y\x05Þ{þJ\x00\x00\x1aÀ/À+À\x11À\x07À\x13À\x09À\x14À[0m" 400 -
172.31.37.196 - - [01/Oct/2025 01:04:37] "GET /customers HTTP/1.1" 200 -
172.31.37.196 - - [01/Oct/2025 01:04:45] "GET /customerprofile/2457 HTTP/1.1" 200 -
205.210.31.13 - - [01/Oct/2025 02:06:13] "GET / HTTP/1.1" 200 -
172.31.37.196 - - [01/Oct/2025 02:22:01] "GET /customers HTTP/1.1" 200 -
172.31.37.196 - - [01/Oct/2025 03:35:45] "GET /customers HTTP/1.1" 200 -
172.31.37.196 - - [01/Oct/2025 03:35:55] "GET /customerprofile/2314 HTTP/1.1" 200 -
172.31.37.196 - - [01/Oct/2025 04:22:54] "GET /customers HTTP/1.1" 200 -
45.156.128.130 - - [01/Oct/2025 04:59:09] "GET / HTTP/1.1" 200 -
172.31.37.196 - - [01/Oct/2025 06:19:42] "GET /customers HTTP/1.1" 200 -
40.76.248.252 - - [01/Oct/2025 07:25:59] code 400, message Bad request syntax ('MGLNDD_18.217.55.107_8081')
40.76.248.252 - - [01/Oct/2025 07:25:59] "[31m[1mMGLNDD_18.217.55.107_8081[0m" 400 -
172.31.37.196 - - [01/Oct/2025 07:50:46] "GET /customers HTTP/1.1" 200 -
172.31.37.196 - - [01/Oct/2025 08:10:10] "GET /customers HTTP/1.1" 200 -
3.136.119.91 - - [01/Oct/2025 08:31:02] "GET / HTTP/1.0" 200 -
3.136.119.91 - - [01/Oct/2025 08:31:07] "[33mGET /nmaplowercheck1759307467 HTTP/1.1[0m" 404 -
3.136.119.91 - - [01/Oct/2025 08:31:07] "[33mPOST /sdk HTTP/1.1[0m" 404 -
3.136.119.91 - - [01/Oct/2025 08:31:07] "GET / HTTP/1.0" 200 -
3.136.119.91 - - [01/Oct/2025 08:31:07] "[33mGET /evox/about HTTP/1.1[0m" 404 -
3.136.119.91 - - [01/Oct/2025 08:31:07] "[33mGET /HNAP1 HTTP/1.1[0m" 404 -
172.31.37.196 - - [01/Oct/2025 08:31:12] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1865, in execute
    ps = cache["ps"][key]
         ~~~~~~~~~~~^^^^^
KeyError: ("select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit 10", ())

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 33, in getcustomers
    cursor.execute(f"select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit {rowlimit}")
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 263, in execute
    raise e
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 256, in execute
    self._c.execute(self, operation, args)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1947, in execute
    self.handle_messages(cursor)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 2236, in handle_messages
    self.message_types[code](self._read(data_len - 4), cursor)
    ~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: b'B'
3.136.119.91 - - [01/Oct/2025 08:31:14] "GET / HTTP/1.0" 200 -
3.136.119.91 - - [01/Oct/2025 08:31:14] "GET / HTTP/1.1" 200 -
3.21.216.255 - - [01/Oct/2025 08:31:21] "GET / HTTP/1.1" 200 -
3.21.216.255 - - [01/Oct/2025 08:31:21] "[33mGET /webhdfs/v1/?op=LISTSTATUS HTTP/1.1[0m" 404 -
3.21.216.255 - - [01/Oct/2025 08:31:21] "[33mGET /api HTTP/1.1[0m" 404 -
3.21.216.255 - - [01/Oct/2025 08:31:21] "[33mGET /config HTTP/1.1[0m" 404 -
3.21.216.255 - - [01/Oct/2025 08:31:21] "[33mGET /api/json HTTP/1.1[0m" 404 -
3.21.216.255 - - [01/Oct/2025 08:31:21] "[33mGET /explorer/index.html HTTP/1.1[0m" 404 -
3.21.216.255 - - [01/Oct/2025 08:31:21] "[33mGET /com.amazon.coral.metadata/model.json HTTP/1.1[0m" 404 -
3.21.216.255 - - [01/Oct/2025 08:31:21] "[33mGET /ws/v1/cluster HTTP/1.1[0m" 404 -
3.21.216.255 - - [01/Oct/2025 08:31:21] "[33mGET /_all_dbs HTTP/1.1[0m" 404 -
3.21.216.255 - - [01/Oct/2025 08:31:21] "[33mGET /login HTTP/1.1[0m" 404 -
3.21.216.255 - - [01/Oct/2025 08:31:21] "[33mGET /info HTTP/1.1[0m" 404 -
3.21.216.255 - - [01/Oct/2025 08:31:21] "[33mGET /version HTTP/1.1[0m" 404 -
3.21.216.255 - - [01/Oct/2025 08:31:21] "[33mGET /conf HTTP/1.1[0m" 404 -
3.21.216.255 - - [01/Oct/2025 08:31:21] "[33mGET /grid/console HTTP/1.1[0m" 404 -
3.21.216.255 - - [01/Oct/2025 08:31:21] "[33mGET /api/v1/trace HTTP/1.1[0m" 404 -
3.21.216.255 - - [01/Oct/2025 08:31:21] "[33mGET /status HTTP/1.1[0m" 404 -
3.21.216.255 - - [01/Oct/2025 08:31:21] "[33mGET /models HTTP/1.1[0m" 404 -
3.21.216.255 - - [01/Oct/2025 08:31:21] "[33mGET /graph HTTP/1.1[0m" 404 -
3.21.216.255 - - [01/Oct/2025 08:31:21] "[33mGET /manager HTTP/1.1[0m" 404 -
52.13.113.61 - - [01/Oct/2025 08:31:32] code 400, message Bad request version ("À\x13À'À")
52.13.113.61 - - [01/Oct/2025 08:31:32] "[31m[1m\x16\x03\x01\x00é\x01\x00\x00å\x03\x03Ë\x17û%_\x98\x13Ä\x08Þ\x8f\x98\x14U¾~\x1c*é\\Ì&f)~;\x1c*Nü\x90g já\x1bó®\x8eÛ­¨&lBW\x9aC\x94|.Z?òmì5/\x98\x04¿f»)y\x00(\x13\x01\x13\x02\x13\x03À+À/À,À0Ì©Ì¨À\x09À\x13À'À[0m" 400 -
52.13.113.61 - - [01/Oct/2025 08:31:32] "GET / HTTP/1.1" 200 -
34.208.134.192 - - [01/Oct/2025 08:31:32] "GET / HTTP/1.1" 200 -
54.71.200.17 - - [01/Oct/2025 08:33:10] "GET / HTTP/1.1" 200 -
54.71.200.17 - - [01/Oct/2025 08:33:11] "GET / HTTP/1.1" 200 -
54.71.200.17 - - [01/Oct/2025 08:33:18] "[33mGET /_cluster/stats HTTP/1.1[0m" 404 -
54.71.200.17 - - [01/Oct/2025 08:33:18] "[33mGET /api/organization/preAuthData HTTP/1.1[0m" 404 -
54.71.200.17 - - [01/Oct/2025 08:33:18] "[33mGET /gremlin/status HTTP/1.1[0m" 404 -
54.71.200.17 - - [01/Oct/2025 08:33:18] "[33mGET /search HTTP/1.1[0m" 404 -
54.71.200.17 - - [01/Oct/2025 08:33:19] "[33mGET /wp-login.php HTTP/1.1[0m" 404 -
54.71.200.17 - - [01/Oct/2025 08:33:19] "[33mGET /v2 HTTP/1.1[0m" 404 -
54.71.200.17 - - [01/Oct/2025 08:33:19] "[33mGET /manifest.json HTTP/1.1[0m" 404 -
54.71.200.17 - - [01/Oct/2025 08:33:19] "[33mGET /_stats/indices HTTP/1.1[0m" 404 -
54.71.200.17 - - [01/Oct/2025 08:33:20] "[33mGET /api/checkHealth HTTP/1.1[0m" 404 -
54.71.200.17 - - [01/Oct/2025 08:33:20] "[33mGET /_cluster/settings?include_defaults=true HTTP/1.1[0m" 404 -
54.71.200.17 - - [01/Oct/2025 08:33:20] "[33mGET /console/login/LoginForm.jsp HTTP/1.1[0m" 404 -
54.71.200.17 - - [01/Oct/2025 08:33:20] "[33mGET /css/emailswitch.css HTTP/1.1[0m" 404 -
54.71.200.17 - - [01/Oct/2025 08:33:20] "[33mGET /added_random_path_for_security_testing HTTP/1.1[0m" 404 -
54.71.200.17 - - [01/Oct/2025 08:33:21] "[33mGET /_xpack/usage HTTP/1.1[0m" 404 -
54.71.200.17 - - [01/Oct/2025 08:33:21] "[33mGET /wp-admin/install.php HTTP/1.1[0m" 404 -
54.71.200.17 - - [01/Oct/2025 08:33:27] "[33mPOST /webui/logoutconfirm.html?menu=1 HTTP/1.1[0m" 404 -
54.71.200.17 - - [01/Oct/2025 08:33:30] "[33mPOST /webui/logoutconfirm.html?logon_hash=1 HTTP/1.1[0m" 404 -
54.71.200.17 - - [01/Oct/2025 08:33:34] "GET / HTTP/1.1" 200 -
3.12.138.139 - - [01/Oct/2025 08:38:09] "GET / HTTP/1.0" 200 -
3.12.138.139 - - [01/Oct/2025 08:38:14] "[33mGET /nmaplowercheck1759307894 HTTP/1.1[0m" 404 -
3.12.138.139 - - [01/Oct/2025 08:38:14] "[33mPOST /sdk HTTP/1.1[0m" 404 -
3.12.138.139 - - [01/Oct/2025 08:38:14] "GET / HTTP/1.0" 200 -
3.12.138.139 - - [01/Oct/2025 08:38:14] "[33mGET /HNAP1 HTTP/1.1[0m" 404 -
3.12.138.139 - - [01/Oct/2025 08:38:14] "[33mGET /evox/about HTTP/1.1[0m" 404 -
3.12.138.139 - - [01/Oct/2025 08:38:21] "GET / HTTP/1.0" 200 -
3.12.138.139 - - [01/Oct/2025 08:38:21] "GET / HTTP/1.1" 200 -
3.12.138.139 - - [01/Oct/2025 08:38:46] "GET / HTTP/1.1" 200 -
3.12.138.139 - - [01/Oct/2025 08:38:46] "[33mGET /webhdfs/v1/?op=LISTSTATUS HTTP/1.1[0m" 404 -
3.12.138.139 - - [01/Oct/2025 08:38:46] "[33mGET /api HTTP/1.1[0m" 404 -
3.12.138.139 - - [01/Oct/2025 08:38:46] "[33mGET /api/json HTTP/1.1[0m" 404 -
3.12.138.139 - - [01/Oct/2025 08:38:46] "[33mGET /config HTTP/1.1[0m" 404 -
3.12.138.139 - - [01/Oct/2025 08:38:46] "[33mGET /explorer/index.html HTTP/1.1[0m" 404 -
3.12.138.139 - - [01/Oct/2025 08:38:46] "[33mGET /com.amazon.coral.metadata/model.json HTTP/1.1[0m" 404 -
3.12.138.139 - - [01/Oct/2025 08:38:46] "[33mGET /ws/v1/cluster HTTP/1.1[0m" 404 -
3.12.138.139 - - [01/Oct/2025 08:38:46] "[33mGET /login HTTP/1.1[0m" 404 -
3.12.138.139 - - [01/Oct/2025 08:38:46] "[33mGET /_all_dbs HTTP/1.1[0m" 404 -
3.12.138.139 - - [01/Oct/2025 08:38:46] "[33mGET /info HTTP/1.1[0m" 404 -
3.12.138.139 - - [01/Oct/2025 08:38:46] "[33mGET /version HTTP/1.1[0m" 404 -
3.12.138.139 - - [01/Oct/2025 08:38:46] "[33mGET /conf HTTP/1.1[0m" 404 -
3.12.138.139 - - [01/Oct/2025 08:38:46] "[33mGET /api/v1/trace HTTP/1.1[0m" 404 -
3.12.138.139 - - [01/Oct/2025 08:38:46] "[33mGET /grid/console HTTP/1.1[0m" 404 -
3.12.138.139 - - [01/Oct/2025 08:38:46] "[33mGET /status HTTP/1.1[0m" 404 -
3.12.138.139 - - [01/Oct/2025 08:38:46] "[33mGET /models HTTP/1.1[0m" 404 -
3.12.138.139 - - [01/Oct/2025 08:38:46] "[33mGET /graph HTTP/1.1[0m" 404 -
3.12.138.139 - - [01/Oct/2025 08:38:46] "[33mGET /manager HTTP/1.1[0m" 404 -
198.235.24.30 - - [01/Oct/2025 10:03:06] code 400, message Bad request version ('À\x13À')
198.235.24.30 - - [01/Oct/2025 10:03:06] "[31m[1m\x16\x03\x01\x00î\x01\x00\x00ê\x03\x03+/\x9aÙ]¸\x1c±Ç}!\x80Æ\x11ä\x03ô\x07\x0cå6¸U\x88\x93Ó\x0cIf®\x108 \x93­!vr/µ\x8eÑ\x98ö\x10fèæ#?Ùþb\x95¤FÒjË\x88èÙ^\x02\x09\x00&À+À/À,À0Ì©Ì¨À\x09À\x13À[0m" 400 -
198.235.24.30 - - [01/Oct/2025 10:03:06] code 400, message Bad request syntax ('\x16\x03\x01\x00Ê\x01\x00\x00Æ\x03\x03¬\x01z³2Ä¦KW&ØðS¶5')
198.235.24.30 - - [01/Oct/2025 10:03:06] "[31m[1m\x16\x03\x01\x00Ê\x01\x00\x00Æ\x03\x03¬\x01z³2Ä¦KW&ØðS¶5[0m" 400 -
195.184.76.237 - - [01/Oct/2025 10:45:11] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
80.75.212.83 - - [01/Oct/2025 11:02:32] "[33mGET /config HTTP/1.1[0m" 404 -
172.31.37.196 - - [01/Oct/2025 11:15:17] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
172.31.37.196 - - [01/Oct/2025 11:15:17] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1865, in execute
    ps = cache["ps"][key]
         ~~~~~~~~~~~^^^^^
KeyError: ("select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit 10", ())

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 33, in getcustomers
    cursor.execute(f"select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit {rowlimit}")
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 263, in execute
    raise e
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 256, in execute
    self._c.execute(self, operation, args)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1947, in execute
    self.handle_messages(cursor)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 2229, in handle_messages
    raise InterfaceError(
    ^
redshift_connector.error.InterfaceError: BrokenPipe: server socket closed. Please check that client side networking configurations such as Proxies, firewalls, VPN, etc. are not affecting your network connection.
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 33, in getcustomers
    cursor.execute(f"select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit {rowlimit}")
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 263, in execute
    raise e
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 254, in execute
    self._c.execute(self, "begin transaction", None)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 2030, in execute
    self.handle_messages_merge_socket_read(cursor)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 2281, in handle_messages_merge_socket_read
    self.message_types[code](last_message_body, cursor)
    ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1793, in handle_ROW_DESCRIPTION
    temp: int = h_unpack(data, idx)[0]
                ~~~~~~~~^^^^^^^^^^^
struct.error: unpack_from requires a buffer of at least 3620 bytes for unpacking 2 bytes at offset 3618 (actual buffer size is 3618)
172.31.37.196 - - [01/Oct/2025 11:15:17] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
172.31.37.196 - - [01/Oct/2025 11:15:17] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
172.31.37.196 - - [01/Oct/2025 11:15:17] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
172.31.37.196 - - [01/Oct/2025 11:15:17] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1865, in execute
    ps = cache["ps"][key]
         ~~~~~~~~~~~^^^^^
KeyError: ("select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit 10", ())

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 33, in getcustomers
    cursor.execute(f"select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit {rowlimit}")
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 263, in execute
    raise e
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 256, in execute
    self._c.execute(self, operation, args)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1947, in execute
    self.handle_messages(cursor)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 2229, in handle_messages
    raise InterfaceError(
    ^
redshift_connector.error.InterfaceError: BrokenPipe: server socket closed. Please check that client side networking configurations such as Proxies, firewalls, VPN, etc. are not affecting your network connection.
172.31.37.196 - - [01/Oct/2025 11:15:17] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1865, in execute
    ps = cache["ps"][key]
         ~~~~~~~~~~~^^^^^
KeyError: ("select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit 10", ())

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 33, in getcustomers
    cursor.execute(f"select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit {rowlimit}")
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 263, in execute
    raise e
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 256, in execute
    self._c.execute(self, operation, args)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1947, in execute
    self.handle_messages(cursor)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 2229, in handle_messages
    raise InterfaceError(
    ^
redshift_connector.error.InterfaceError: BrokenPipe: server socket closed. Please check that client side networking configurations such as Proxies, firewalls, VPN, etc. are not affecting your network connection.
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1865, in execute
    ps = cache["ps"][key]
         ~~~~~~~~~~~^^^^^
KeyError: ("select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit 10", ())

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 33, in getcustomers
    cursor.execute(f"select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit {rowlimit}")
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 263, in execute
    raise e
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 256, in execute
    self._c.execute(self, operation, args)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1947, in execute
    self.handle_messages(cursor)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 2229, in handle_messages
    raise InterfaceError(
    ^
redshift_connector.error.InterfaceError: BrokenPipe: server socket closed. Please check that client side networking configurations such as Proxies, firewalls, VPN, etc. are not affecting your network connection.
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1865, in execute
    ps = cache["ps"][key]
         ~~~~~~~~~~~^^^^^
KeyError: ("select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit 10", ())

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 33, in getcustomers
    cursor.execute(f"select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit {rowlimit}")
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 263, in execute
    raise e
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 256, in execute
    self._c.execute(self, operation, args)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1947, in execute
    self.handle_messages(cursor)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 2229, in handle_messages
    raise InterfaceError(
    ^
redshift_connector.error.InterfaceError: BrokenPipe: server socket closed. Please check that client side networking configurations such as Proxies, firewalls, VPN, etc. are not affecting your network connection.
172.31.37.196 - - [01/Oct/2025 11:15:17] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
172.31.37.196 - - [01/Oct/2025 11:15:17] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1865, in execute
    ps = cache["ps"][key]
         ~~~~~~~~~~~^^^^^
KeyError: ("select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit 10", ())

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 33, in getcustomers
    cursor.execute(f"select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit {rowlimit}")
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 263, in execute
    raise e
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 256, in execute
    self._c.execute(self, operation, args)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1947, in execute
    self.handle_messages(cursor)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 2229, in handle_messages
    raise InterfaceError(
    ^
redshift_connector.error.InterfaceError: BrokenPipe: server socket closed. Please check that client side networking configurations such as Proxies, firewalls, VPN, etc. are not affecting your network connection.
172.31.37.196 - - [01/Oct/2025 11:15:17] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1865, in execute
    ps = cache["ps"][key]
         ~~~~~~~~~~~^^^^^
KeyError: ("select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit 10", ())

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 33, in getcustomers
    cursor.execute(f"select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit {rowlimit}")
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 263, in execute
    raise e
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 256, in execute
    self._c.execute(self, operation, args)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1947, in execute
    self.handle_messages(cursor)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 2229, in handle_messages
    raise InterfaceError(
    ^
redshift_connector.error.InterfaceError: BrokenPipe: server socket closed. Please check that client side networking configurations such as Proxies, firewalls, VPN, etc. are not affecting your network connection.
172.31.37.196 - - [01/Oct/2025 11:15:17] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1865, in execute
    ps = cache["ps"][key]
         ~~~~~~~~~~~^^^^^
KeyError: ("select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit 10", ())

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 33, in getcustomers
    cursor.execute(f"select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit {rowlimit}")
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 263, in execute
    raise e
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 256, in execute
    self._c.execute(self, operation, args)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1947, in execute
    self.handle_messages(cursor)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 2229, in handle_messages
    raise InterfaceError(
    ^
redshift_connector.error.InterfaceError: BrokenPipe: server socket closed. Please check that client side networking configurations such as Proxies, firewalls, VPN, etc. are not affecting your network connection.
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1865, in execute
    ps = cache["ps"][key]
         ~~~~~~~~~~~^^^^^
KeyError: ("select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit 10", ())

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 33, in getcustomers
    cursor.execute(f"select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit {rowlimit}")
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 263, in execute
    raise e
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 256, in execute
    self._c.execute(self, operation, args)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1947, in execute
    self.handle_messages(cursor)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 2229, in handle_messages
    raise InterfaceError(
    ^
redshift_connector.error.InterfaceError: BrokenPipe: server socket closed. Please check that client side networking configurations such as Proxies, firewalls, VPN, etc. are not affecting your network connection.
172.31.37.196 - - [01/Oct/2025 11:15:17] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1865, in execute
    ps = cache["ps"][key]
         ~~~~~~~~~~~^^^^^
KeyError: ("select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit 10", ())

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 33, in getcustomers
    cursor.execute(f"select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit {rowlimit}")
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 263, in execute
    raise e
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 256, in execute
    self._c.execute(self, operation, args)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1947, in execute
    self.handle_messages(cursor)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 2229, in handle_messages
    raise InterfaceError(
    ^
redshift_connector.error.InterfaceError: BrokenPipe: server socket closed. Please check that client side networking configurations such as Proxies, firewalls, VPN, etc. are not affecting your network connection.
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1865, in execute
    ps = cache["ps"][key]
         ~~~~~~~~~~~^^^^^
KeyError: ("select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit 10", ())

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 33, in getcustomers
    cursor.execute(f"select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit {rowlimit}")
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 263, in execute
    raise e
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 256, in execute
    self._c.execute(self, operation, args)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1947, in execute
    self.handle_messages(cursor)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 2229, in handle_messages
    raise InterfaceError(
    ^
redshift_connector.error.InterfaceError: BrokenPipe: server socket closed. Please check that client side networking configurations such as Proxies, firewalls, VPN, etc. are not affecting your network connection.
172.31.37.196 - - [01/Oct/2025 12:01:21] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1865, in execute
    ps = cache["ps"][key]
         ~~~~~~~~~~~^^^^^
KeyError: ("select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit 10", ())

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 33, in getcustomers
    cursor.execute(f"select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit {rowlimit}")
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 263, in execute
    raise e
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 256, in execute
    self._c.execute(self, operation, args)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1947, in execute
    self.handle_messages(cursor)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 2229, in handle_messages
    raise InterfaceError(
    ^
redshift_connector.error.InterfaceError: BrokenPipe: server socket closed. Please check that client side networking configurations such as Proxies, firewalls, VPN, etc. are not affecting your network connection.
172.31.37.196 - - [01/Oct/2025 12:07:43] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1865, in execute
    ps = cache["ps"][key]
         ~~~~~~~~~~~^^^^^
KeyError: ("select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit 10", ())

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 33, in getcustomers
    cursor.execute(f"select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit {rowlimit}")
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 263, in execute
    raise e
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 256, in execute
    self._c.execute(self, operation, args)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1947, in execute
    self.handle_messages(cursor)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 2229, in handle_messages
    raise InterfaceError(
    ^
redshift_connector.error.InterfaceError: BrokenPipe: server socket closed. Please check that client side networking configurations such as Proxies, firewalls, VPN, etc. are not affecting your network connection.
172.31.37.196 - - [01/Oct/2025 13:46:49] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1865, in execute
    ps = cache["ps"][key]
         ~~~~~~~~~~~^^^^^
KeyError: ("select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit 10", ())

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 33, in getcustomers
    cursor.execute(f"select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit {rowlimit}")
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 263, in execute
    raise e
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 256, in execute
    self._c.execute(self, operation, args)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1940, in execute
    self._flush()
    ~~~~~~~~~~~^^
  File "/usr/lib64/python3.13/socket.py", line 737, in write
    return self._sock.send(b)
           ~~~~~~~~~~~~~~~^^^
  File "/usr/lib64/python3.13/ssl.py", line 1232, in send
    return self._sslobj.write(data)
           ~~~~~~~~~~~~~~~~~~^^^^^^
ssl.SSLZeroReturnError: TLS/SSL connection has been closed (EOF) (_ssl.c:2493)
172.31.37.196 - - [01/Oct/2025 13:47:05] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1865, in execute
    ps = cache["ps"][key]
         ~~~~~~~~~~~^^^^^
KeyError: ("select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit 10", ())

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 33, in getcustomers
    cursor.execute(f"select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit {rowlimit}")
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 263, in execute
    raise e
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 256, in execute
    self._c.execute(self, operation, args)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1940, in execute
    self._flush()
    ~~~~~~~~~~~^^
  File "/usr/lib64/python3.13/socket.py", line 737, in write
    return self._sock.send(b)
           ~~~~~~~~~~~~~~~^^^
  File "/usr/lib64/python3.13/ssl.py", line 1232, in send
    return self._sslobj.write(data)
           ~~~~~~~~~~~~~~~~~~^^^^^^
ssl.SSLZeroReturnError: TLS/SSL connection has been closed (EOF) (_ssl.c:2493)
172.31.37.196 - - [01/Oct/2025 13:48:04] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1865, in execute
    ps = cache["ps"][key]
         ~~~~~~~~~~~^^^^^
KeyError: ("select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit 10", ())

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 33, in getcustomers
    cursor.execute(f"select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit {rowlimit}")
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 263, in execute
    raise e
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 256, in execute
    self._c.execute(self, operation, args)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1940, in execute
    self._flush()
    ~~~~~~~~~~~^^
  File "/usr/lib64/python3.13/socket.py", line 737, in write
    return self._sock.send(b)
           ~~~~~~~~~~~~~~~^^^
  File "/usr/lib64/python3.13/ssl.py", line 1232, in send
    return self._sslobj.write(data)
           ~~~~~~~~~~~~~~~~~~^^^^^^
ssl.SSLZeroReturnError: TLS/SSL connection has been closed (EOF) (_ssl.c:2493)
172.31.37.196 - - [01/Oct/2025 13:48:19] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1865, in execute
    ps = cache["ps"][key]
         ~~~~~~~~~~~^^^^^
KeyError: ("select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit 10", ())

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 33, in getcustomers
    cursor.execute(f"select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit {rowlimit}")
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 263, in execute
    raise e
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 256, in execute
    self._c.execute(self, operation, args)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1940, in execute
    self._flush()
    ~~~~~~~~~~~^^
  File "/usr/lib64/python3.13/socket.py", line 737, in write
    return self._sock.send(b)
           ~~~~~~~~~~~~~~~^^^
  File "/usr/lib64/python3.13/ssl.py", line 1232, in send
    return self._sslobj.write(data)
           ~~~~~~~~~~~~~~~~~~^^^^^^
ssl.SSLZeroReturnError: TLS/SSL connection has been closed (EOF) (_ssl.c:2493)
172.31.37.196 - - [01/Oct/2025 13:48:37] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1865, in execute
    ps = cache["ps"][key]
         ~~~~~~~~~~~^^^^^
KeyError: ("select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit 10", ())

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 33, in getcustomers
    cursor.execute(f"select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit {rowlimit}")
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 263, in execute
    raise e
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 256, in execute
    self._c.execute(self, operation, args)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1940, in execute
    self._flush()
    ~~~~~~~~~~~^^
  File "/usr/lib64/python3.13/socket.py", line 737, in write
    return self._sock.send(b)
           ~~~~~~~~~~~~~~~^^^
  File "/usr/lib64/python3.13/ssl.py", line 1232, in send
    return self._sslobj.write(data)
           ~~~~~~~~~~~~~~~~~~^^^^^^
ssl.SSLZeroReturnError: TLS/SSL connection has been closed (EOF) (_ssl.c:2493)
172.31.37.196 - - [01/Oct/2025 13:48:55] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1865, in execute
    ps = cache["ps"][key]
         ~~~~~~~~~~~^^^^^
KeyError: ("select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit 10", ())

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 33, in getcustomers
    cursor.execute(f"select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit {rowlimit}")
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 263, in execute
    raise e
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 256, in execute
    self._c.execute(self, operation, args)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1940, in execute
    self._flush()
    ~~~~~~~~~~~^^
  File "/usr/lib64/python3.13/socket.py", line 737, in write
    return self._sock.send(b)
           ~~~~~~~~~~~~~~~^^^
  File "/usr/lib64/python3.13/ssl.py", line 1232, in send
    return self._sslobj.write(data)
           ~~~~~~~~~~~~~~~~~~^^^^^^
ssl.SSLZeroReturnError: TLS/SSL connection has been closed (EOF) (_ssl.c:2493)
76.193.45.35 - - [01/Oct/2025 13:49:03] "[35m[1mGET /customers HTTP/1.1[0m" 500 -
Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1865, in execute
    ps = cache["ps"][key]
         ~~~~~~~~~~~^^^^^
KeyError: ("select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit 10", ())

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/extension.py", line 176, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/flask_cors/decorator.py", line 121, in wrapped_function
    resp = make_response(f(*args, **kwargs))
                         ~^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/server/app.py", line 42, in getcustomers
    results=customerdata.getcustomers(rowlimit=rowlimit)
  File "/home/ec2-user/awspalette/server/utils/database/cdp.py", line 33, in getcustomers
    cursor.execute(f"select customer_id,first_name+' '+last_name as name,datediff(year,birth_date,current_date) as age,email,loyalty_level,to_char(total_purchases,'99999.99'),is_active from customer where age> 20 limit {rowlimit}")
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 263, in execute
    raise e
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/cursor.py", line 256, in execute
    self._c.execute(self, operation, args)
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ec2-user/awspalette/development/lib64/python3.13/site-packages/redshift_connector/core.py", line 1940, in execute
    self._flush()
    ~~~~~~~~~~~^^
  File "/usr/lib64/python3.13/socket.py", line 737, in write
    return self._sock.send(b)
           ~~~~~~~~~~~~~~~^^^
  File "/usr/lib64/python3.13/ssl.py", line 1232, in send
    return self._sslobj.write(data)
           ~~~~~~~~~~~~~~~~~~^^^^^^
ssl.SSLZeroReturnError: TLS/SSL connection has been closed (EOF) (_ssl.c:2493)
76.193.45.35 - - [01/Oct/2025 13:49:03] "GET /customers?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1" 200 -
76.193.45.35 - - [01/Oct/2025 13:49:03] "GET /customers?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1" 200 -
76.193.45.35 - - [01/Oct/2025 13:49:03] "GET /customers?__debugger__=yes&cmd=resource&f=console.png HTTP/1.1" 200 -
